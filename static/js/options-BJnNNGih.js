import{d as D,i as M,u as R}from"./Bot-DBDjahQk.js";import{d as Y,r as s,A as u,u as o,i as t,M as a,v as l,B,C as c,y as f,g as q,F as S,q as j,a_ as z,aY as G,aI as _,_ as H}from"./index-CpafBiW4.js";import{i as J}from"./home-dZ3xXtdR.js";import{_ as K}from"./timeline.vue_vue_type_script_setup_true_lang-CRDXn5Bq.js";const O=Y({__name:"options",props:{data:{default:()=>({info:{title:"",desc:"",authors:[],link:"",name:""},installed:!1})},addInstall:{type:Function,default:()=>{}},removeInstall:{type:Function,default:()=>{}}},setup(E){const v=E,e=s(v.data),C=s("info"),g=s(""),x=s(!0),m=s(""),k=s([]),L=s(!0),I=s(""),w=i=>{switch(i){case"readme":g.value||D(e.value.info.link).then(n=>{x.value=!1,n.success?g.value=n.data.replace(/YePanel\/api\/transit\?/g,`${z().replace(/\/$/,"")}/api/transit?accessToken=${G().accessToken}&`):m.value=n.message});break;case"updateLog":k.value.length||J(e.value.info.name).then(n=>{L.value=!1,n.success?k.value=n.data.log:I.value=n.message});break}},b=s(!1),y=s(!1),F=()=>{b.value=!0,M(e.value.info.link).then(i=>{b.value=!1,i.success?(_("安装成功~Ciallo～(∠・ω< )⌒☆",{type:"success",customClass:"el"}),v.addInstall(e.value.info.name),e.value.installed=!0):_(i.message,{type:"error",customClass:"el"})})},N=()=>{y.value=!0,R(e.value.info.name).then(i=>{y.value=!1,i.success?(v.removeInstall(e.value.info.name),e.value.installed=!1,_("卸载成功~Ciallo～(∠・ω< )⌒☆",{type:"success",customClass:"el"})):_("卸载失败..."+i.message,{type:"error",customClass:"el"})})};return(i,n)=>{const r=u("el-descriptions-item"),T=u("el-link"),V=u("el-button"),P=u("el-descriptions"),h=u("el-tab-pane"),p=u("el-result"),$=u("v-md-preview"),A=u("el-scrollbar"),U=u("el-tabs");return t(),o(U,{modelValue:C.value,"onUpdate:modelValue":n[0]||(n[0]=d=>C.value=d),class:"mb-[20px]",onTabChange:w},{default:a(()=>[l(h,{label:"详情",name:"info"},{default:a(()=>[l(P,{border:"",column:1},{default:a(()=>[l(r,{label:"标题"},{default:a(()=>[c(f(e.value.info.title),1)]),_:1}),l(r,{label:"名称"},{default:a(()=>[c(f(e.value.info.name),1)]),_:1}),l(r,{label:"链接"},{default:a(()=>[l(T,{underline:!1,href:e.value.info.link,target:"_blank",type:"primary"},{default:a(()=>[c(f(e.value.info.link),1)]),_:1},8,["href"])]),_:1}),l(r,{label:"作者"},{default:a(()=>[(t(!0),q(S,null,j(e.value.info.authors,d=>(t(),o(T,{key:d.link,underline:!1,href:d.link,target:"_blank",type:d.link?"primary":"default",class:"mr-[10px]"},{default:a(()=>[c(f(d.name),1)]),_:2},1032,["href","type"]))),128))]),_:1}),l(r,{label:"描述"},{default:a(()=>[c(f(e.value.info.desc),1)]),_:1}),l(r,{label:"操作"},{default:a(()=>[e.value.installed?(t(),o(V,{key:1,type:"danger",loading:y.value,onClick:N},{default:a(()=>[c(" 卸载 ")]),_:1},8,["loading"])):(t(),o(V,{key:0,type:"success",loading:b.value,onClick:F},{default:a(()=>[c(" 安装 ")]),_:1},8,["loading"]))]),_:1})]),_:1})]),_:1}),l(h,{label:"README",name:"readme",class:"flex-c"},{default:a(()=>[l(A,null,{default:a(()=>[x.value?(t(),o(p,{key:0,icon:"info",title:"加载中..."})):m.value?(t(),o(p,{key:1,icon:"error",title:m.value},null,8,["title"])):B("",!0),l($,{text:g.value},null,8,["text"])]),_:1})]),_:1}),e.value.installed?(t(),o(h,{key:0,label:"更新日志",name:"updateLog",class:"flex-c"},{default:a(()=>[L.value?(t(),o(p,{key:0,icon:"info",title:"加载中..."})):I.value?(t(),o(p,{key:1,icon:"error",title:m.value},null,8,["title"])):(t(),o(K,{key:2,log:k.value,link:e.value.info.link},null,8,["log","link"]))]),_:1})):B("",!0)]),_:1},8,["modelValue"])}}}),ee=H(O,[["__scopeId","data-v-5808755f"]]);export{ee as default};
